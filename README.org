#+TITLE: Gemini REPL
#+AUTHOR: jwalsh
#+DATE: 2025-07-13

[[https://github.com/aygp-dr/gemini-repl/blob/main/LICENSE][https://img.shields.io/badge/License-MIT-blue.svg]]
[[https://www.freebsd.org/][https://img.shields.io/badge/FreeBSD-14.3-red.svg]]
[[https://clojure.org/releases/tools][https://img.shields.io/badge/Clojure-1.12.0-blue.svg]]
[[https://nodejs.org/][https://img.shields.io/badge/Node.js-22.14-green.svg]]
[[https://lamport.azurewebsites.net/tla/tla.html][https://img.shields.io/badge/TLA+-1.8.0-purple.svg]]
[[https://alloytools.org/][https://img.shields.io/badge/Alloy-6.0.0-orange.svg]]
[[https://orgmode.org/][https://img.shields.io/badge/Org--Mode-9.7-green.svg]]

* Overview

An interactive console application for the Google Gemini API with formal specifications.

* Setup

1. Copy =.env.example= to =.env= and add your API key
2. Install dependencies (see language-specific instructions)
3. Run the REPL

* Project Structure

- =specs/= - Formal specifications (TLA+, Alloy)
- =src/= - Implementation
- =tests/= - Property-based tests
- =docs/= - Documentation

* Features

** Current Features

*** Core REPL Functionality
- Interactive console for Gemini API interactions
- Slash commands (=/help=, =/exit=, =/clear=, =/stats=, =/debug=)
- Session state tracking with token usage and cost estimation
- Environment-based configuration

*** Enhanced UI (NEW!)
- **ğŸ”¹ Confidence Indicators**: Visual feedback on response quality
  - ğŸŸ¢ High confidence (>95%)
  - ğŸŸ¡ Medium confidence (>80%)
  - ğŸ”´ Low confidence (â‰¤80%)
- **ğŸ“Š Response Metadata**: Detailed information when =GEMINI_SHOW_METADATA=true=
  - Token usage and costs
  - Response timing
  - Session totals
- **ğŸ“ Comprehensive Logging**: FIFO and file logging with configurable levels

*** Development Infrastructure
- **ğŸ§ª Testing**: Unit tests for core functionality (=gmake test-cljs=)
- **ğŸ” Linting**: ClojureScript (clj-kondo) and shell script linting
- **ğŸš€ CI/CD**: GitHub Actions for automated testing and linting
- **ğŸ“¦ Release Management**: Automated versioning and release creation

** Configuration

Set these environment variables to customize behavior:

#+BEGIN_SRC bash
# Required
export GEMINI_API_KEY="your-api-key"

# Optional UI settings
export GEMINI_SHOW_METADATA=true     # Show response metadata
export GEMINI_MODEL=gemini-2.0-flash # Model selection
export GEMINI_TEMPERATURE=0.9        # Response creativity
export GEMINI_MAX_TOKENS=2048        # Max response length

# Logging configuration
export GEMINI_LOG_ENABLED=true       # Enable logging
export GEMINI_LOG_TYPE=both          # fifo, file, or both
export GEMINI_LOG_LEVEL=debug        # debug or info
#+END_SRC

** Quick Start

#+BEGIN_SRC bash
# Install dependencies
gmake install

# Run tests
gmake test

# Start REPL
gmake run

# Development mode with hot reload
gmake dev
#+END_SRC

** Future Work: Self-Hosting Experimentation Platform ğŸš€

*** Vision
Transform the REPL into a self-improving system that can modify its own code through experimentation.

*** Planned Features (Issue #43)

**** ğŸ§ª Git Worktree Experiments
- Create isolated experiments: =/experiment new <name>=
- Switch between experiments: =/experiment switch <name>=
- Test and merge successful changes

**** ğŸ• Dogfooding Mode
- Enable with =/dogfood= command
- REPL can modify its own source code
- Hot-reload changes automatically
- AI-assisted feature development

**** ğŸ“š Research Documentation
- =/research new <topic>= - Create research documents
- =/research log <finding>= - Track experimental results
- Automatic org-mode documentation

**** Example Workflow
#+BEGIN_SRC
> /experiment new ui-enhancement "Add color themes"
ğŸ§ª Creating experiment: ui-enhancement

> /dogfood
ğŸ• Dogfooding mode enabled!

> Add a dark theme option to the REPL
[REPL modifies its own code...]
âœ… Feature added! Try /theme dark

> /research log "Dark theme reduces eye strain in terminal"
ğŸ“ Finding logged
#+END_SRC

This speculative feature represents the ultimate goal: a REPL that evolves through self-experimentation.

* Formal Methods

This project uses formal specifications to define system behavior before implementation.
See =specs/README.md= for details.